# =========================================
# NSM-123 Safe Security Headers (HostGator)
# =========================================

# Prevent directory listings
Options -Indexes

# Core security headers (apply to all responses)
<IfModule mod_headers.c>
  Header always set X-Content-Type-Options "nosniff"
  Header always set X-Frame-Options "SAMEORIGIN"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"

  # Minimal feature lockdown (static + PHP)
  Header always set Permissions-Policy "geolocation=(), microphone=(), camera=(), payment=(), usb=(), accelerometer=(), gyroscope=(), magnetometer=()"

  # Reduce stack fingerprinting
  Header always unset X-Powered-By
</IfModule>

# HSTS only when HTTPS is on (no expr=)
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteCond %{HTTPS} on
  <IfModule mod_headers.c>
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
  </IfModule>
</IfModule>

# Custom error documents (keep or remove if you don't have these files)
ErrorDocument 404 /404.html
ErrorDocument 500 /500.html
